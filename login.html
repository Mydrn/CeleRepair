<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>欢迎登录</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="css/mui.min.css">
		<link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_n5o6ioc4rv8to6r.css" />
		<style>
			body,html{background-color:#efeff4}span.mui-icon{font-size:20px;color:#fff}.mui-off-canvas-left{color:#fff}.title{margin:35px 15px 10px}.title+.content{margin:10px 15px 35px;color:#bbb;text-indent:1em;font-size:14px;line-height:24px}.mui-repair{width:44%;padding:4% 0;margin:0 0 0 4%;color:#fff;border:0;background:#92b0dd;border-radius:10px}.mui-repair-left{margin-right:4%;background:#e0b6b6}.f-white{color:#fff!important}.f-14{font-size:14px!important}.bg-orange{background-color:#ff5700!important}.order-null{text-align:center;padding-top:20%}.icon-left{left:0;font-size:20px;font-weight:400}.mui-filter{-webkit-filter:blur(6px);-moz-filter:blur(6px);-o-filter:blur(6px);-ms-filter:blur(6px);filter:blur(6px)}.login-content{padding-top:30%}.login-content img{margin-bottom:15%}.transparent{background:0 0}.f-blank{color:#000!important}#login{position:fixed;top:0;left:0;right:0;bottom:0;z-index:99;text-align:center;background:rgba(120,120,120,.75)}#login .f-login{background:0 0;box-sizing:border-box;padding:3px 5px 4px}#login .mui-input-group{background:0 0;padding:0 10px}#login .mui-input-row input{border:1px solid #a7a7a7;border-radius:6px;padding:8px 10px 8px 38px}#login .mui-input-row{margin-bottom:10px}#login header a{color:#fff}.mui-box-shadow-none{box-shadow:none}.mui-input-group .mui-input-row:after{background:0 0}.mui-right{float:right}.forget{padding: 8px 0 0;}
		</style>
	</head>
	<body>
		<div id="login">
			<header class="mui-bar mui-bar-nav transparent mui-box-shadow-none">
				<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
				<h1 class="mui-title">欢迎登录</h1>
				<a href="../page/treaty.jsp" class="mui-btn mui-pull-right f-login">注册</a>
			</header>
			<div class="login-content">
				<div><img src="images/celerepair-logo.png" style="width: 60%;" /></div>
				<form class="mui-input-group">
					<div class="mui-input-row">
						<span class="iconfont icon-shoujihao icon-left"></span>
						<input type="text" id="customerName" data-input-password="3" placeholder="手机号/账号">
					</div>
					<div class="mui-input-row">
						<span class="iconfont icon-denglumima icon-left"></span>
						<input type="password" id="password" class="mui-input-password" data-input-password="3" placeholder="密码">
						<span class="iconfont icon-off-yanjing" onclick="see(this)"></span>
					</div>
					<input type="button" id="submit" value="登录" class="mui-btn mui-btn-block bg-orange f-white" />
					<a href="${ctx}/page/h5/forget-password.jsp" class="mui-right f-white f-14 forget">忘记密码</a>
				</form>
			</div>
		</div>
		<script src="js/mui.min.js"></script>
		<script src="js/app.js"></script>
		<script>
			mui.init();
			mui.init({
				swipeBack: true //启用右滑关闭功能
			});
			//实现ios平台原生侧滑关闭页面；
			if(mui.os.plus && mui.os.ios) {
				mui.plusReady(function() {
					//5+ iOS暂时无法屏蔽popGesture时传递touch事件，故该demo直接屏蔽popGesture功能
					plus.webview.currentWebview().setStyle({
						'popGesture': 'none'
					});
				});
			}
			//开启A标签的跳转
			mui('body').on('tap', 'a', function() {
				window.top.location.href = this.href;
			});
			function see(e) {
				var pass = e.previousElementSibling;
				if(pass.getAttribute('type') == "password") {
					pass.setAttribute("type", "text");
					e.setAttribute('class', e.getAttribute('class').replace(/off/, "no"));
				} else {
					pass.setAttribute("type", "password");
					e.setAttribute('class', e.getAttribute('class').replace(/no/, "off"));
				}
			};
			var customerName = document.getElementById('customerName');
			var password = document.getElementById('password');
			document.getElementById('submit').addEventListener('tap',function(){
				if(customerName.value.replace(/(^s*)|(s*$)/g, "").length == 0){
					return mui.toast("请填写手机号码或帐号");
				}
				if(password.value.replace(/(^s*)|(s*$)/g, "").length < 6){
					return mui.toast("请填写正确格式的密码");
				}
				var loginInfo = {
							customerName: customerName.value,
							password: password.value
						};
				app.login(loginInfo, function(err) {
							if (err) {
								plus.nativeUI.toast(err);
								return;
							}
							var newpage = plus.webview.create("index.jsp","index",{},{
									});
									newpage.show();
						});
		   });
		</script>
	</body>
</html>